## Netlify graph & NextJS starter for "near me" apps

Today we are going to explore the popular tool NextJS and one of its newer features, geolocation middleware in a project that lets you browse nearby breweries! 

We are going to start by creating a NextJS app using a template:
```
npx create-next-app@latest
```

This gives us some default application scaffolding which we will take advantage of. If you cd into the directory we just created we should now see the application structure below. 

Next (boy, "Next" is going to be an overloaded word in this article, I apologize in advance!) we will want to register for an API key for whatever API we want to use in conjunction with our geolocation software. For myself, I'm using a brewery API. Going to [this url](https://beermapping.com/api/request/) we can request an API key, which you should save for later. Poking around the site a little bit, I see what look to be relatively limited [code examples](https://beermapping.com/api/examples/), all in PHP(?) so we may be in for a bit of an adventure figuring this out. 

If we run `npm run dev` without altering the existing scaffolding, we are pointed to some boilerplate next docs. I like the styling of this well enough already so I may just lean into the defaults for this project. We are going to want to clear out this default content though, so I'm going to head to `pages/index.js` and remove some things. A new bare bones homepage will feature this icon, found [here](https://www.iconfinder.com/search?q=beer&price=free). The updated `pages/index.js` will be simplified to this: 

```
import Head from 'next/head'
import Image from 'next/image'
import styles from '../styles/Home.module.css'

export default function Home() {
  return (
    <div className={styles.container}>
      <Head>
        <title>Brewery finder</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/beer.png" />
      </Head>

      <main className={styles.main}>
        <h1 className={styles.title}>
          Brewery finder
        </h1>
        <div className="imageWrapper">
          <Image id="headerImage" width="60px" height="60px" alt="beer" src="/beer.png"/>
        </div>
      </main>

      <footer className={styles.footer}>
        <a
          href="https://vercel.com?utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app"
          target="_blank"
          rel="noopener noreferrer"
        >
          Powered by{' '}
          <span className={styles.logo}>
            <Image src="/vercel.svg" alt="Vercel Logo" width={72} height={16} />
          </span>
        </a>
      </footer>
    </div>
  )
}
```

And we will add a tiny line to `styles/globals.css` for some spacing.

```
div.imageWrapper {
  padding:20px;
}
```

Already I've noticed what feels like sort of irregular rules for handling images in NextJS, can't say I love that but let's move along. Let's next create in our top level dir an environment file for our api key. For NextJS, we need to call this `.env.local`. Use the API key from your own account on the brewery API or whichever "near me" API you chose to use instead. At this point we should have `.env.local` looking like an uncensored version of this.

```
API_KEY=xxxxx
```

At this point I'm going to switch gears a little bit and dive into [this portion](https://nextjs.org/docs/advanced-features/middleware) of the NextJS docs, which pertain to middleware. "What is middleware" you might ask? I sort of hate this term. It was one of those terms that sounded weirdly intimidating to me as a junior developer. The answer in terms of what it means in my practical life is that middleware is just code like anything else, although my old employer Red Hat does offer a more precise [definition](https://www.redhat.com/en/topics/middleware/what-is-middleware). 

Following along with the docs, I'm going to run `mkdir src && touch src/middleware.js` from my terminal, then head to our newly created `middleware.js` file. 

